<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Deploy middleman-loaded to Github Pages | beesbot</title>
    <meta name="viewport" content="width=device-width">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

</head>
<body class="internal-layout">

  <header class="site-header" role="banner">
     <div class="container">
      
     <!-- <nav class="site-nav" role="navigation">
        <div class="nav-links">
            <a href="/" href="/">Home</a>
            <a href="/about" href="/about">About</a>
            <a href="/blog" href="/about">Blog</a>
            <div class="mobile-menu"><i class="icon-reorder"></i></div>
        </div>
      </nav>-->

      <a href="/"><img src="/images/logo_no_bee.png" alt="beesbot - a technology group" width="250" class="navbar-brand" /></a>

    </div>
  </header>
  <main class="site-main" role="main">
     <div class="container">

        <h1>Deploy middleman-loaded to Github Pages</h1>
<p class="meta">27 Mar 2014</p>

<div class="post">
<p>There are significant structural difference between Github Project &amp; User Pages.  Deployment and domain configuration can be complication, but I&#39;ve streamlined the process with <a href="https://github.com/dnajd/middleman-loaded">middleman-loaded</a>.  First a summary of the differences between Github Project &amp; User Pages.</p>

<h3>Project Pages</h3>

<ul>
<li>The url is something like: http://username.github.io/project-name  (Troublesome)</li>
<li>You can have as many of these as your want</li>
<li>Generated site must be pushed to a &#39;gh-pages&#39; branch (Awesome!)</li>
<li>Deploying is really easy</li>
</ul>

<h3>User Pages</h3>

<ul>
<li>the url is simply: http://username.github.io.<br></li>
<li>You can only have one of these per github account</li>
<li>Generated site must be pushed to &#39;master&#39; branch (LAME!).</li>
<li>Deploying requires this blog post</li>
</ul>

<h1>Deploy Project Pages</h1>

<p>Project Pages are simple so I&#39;ll cover that first.  </p>

<h3>Clone &amp; Build</h3>

<div class="highlight"><pre><code class="bash">git clone git@github.com:dnajd/middleman-loaded.git my-project.com
<span class="nb">cd </span>my-project.com
bundle install
</code></pre></div>

<h2>Git Work</h2>

<p>Remove the git folder</p>

<div class="highlight"><pre><code class="bash">rm -rf .git
</code></pre></div>

<p>Init a new git repo and add middleman-loaded as your upstream</p>

<div class="highlight"><pre><code class="bash">git init .
git add .
git commit -m<span class="s2">&quot;forked middleman for github user pages&quot;</span>
git remote add upstream git@github.com:dnajd/middleman-loaded.git
</code></pre></div>

<p>Now browse to <a href="http://www.github.com">Github</a>, manually create your repository and name it whatever you want.</p>

<p>Then add a remote &amp; push &#39;origin master&#39;</p>

<div class="highlight"><pre><code class="bash">git remote add origin git@github.com:username/whatever-your-named-it.git
git push -u origin master
</code></pre></div>

<h3>Configure Middleman</h3>

<p>In the config.rb uncomment the deployment settings</p>

<div class="highlight"><pre><code class="ruby"><span class="c1"># github project pages deploy</span>
<span class="n">activate</span> <span class="ss">:deploy</span> <span class="k">do</span> <span class="o">|</span><span class="n">deploy</span><span class="o">|</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="ss">:git</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">build_before</span> <span class="o">=</span> <span class="kp">true</span> <span class="c1"># default: false</span>
<span class="k">end</span>
</code></pre></div>

<p>And remember to commit your changes</p>

<div class="highlight"><pre><code class="bash">git add .
git commit -m<span class="s2">&quot;configured for deployment to github project pages&quot;</span>
git push
</code></pre></div>

<h3>Deploy</h3>

<div class="highlight"><pre><code class="bash">bundle <span class="nb">exec </span>middleman deploy
</code></pre></div>

<h3>Configure Custom Domain</h3>

<p>Project pages are hosted under a url under your user (ex. http://username.github.io/my-project.com).  This means path references and images will likely be broken. Pointing a custom domain at this fixes everything, but requires to DNS settings.</p>

<ul>
<li>create a CNAME Record from: www.my-project.com to username.github.io</li>
<li>create an A Record for: my-project.com to ipaddress (dig username.github.io)</li>
</ul>

<h1>Deploy User Pages</h1>

<p>User pages have their benefits, but deploying with middleman is a bit more complicated.  Here are the steps.</p>

<h2>Clone &amp; Build</h2>

<div class="highlight"><pre><code class="bash">git clone git@github.com:dnajd/middleman-loaded.git username.github.io
bundle install
</code></pre></div>

<h2>Git Work</h2>

<p>Remember User Pages require the generated site to be in branch &#39;master&#39;.  To get our code into a branch called &#39;source&#39;, we&#39;ll first remove the .git folder</p>

<div class="highlight"><pre><code class="bash"><span class="nb">cd </span>username.github.io
rm -rf .git
</code></pre></div>

<p>Init a new git repo with branch &#39;source&#39;</p>

<div class="highlight"><pre><code class="bash">git init .
git checkout -b <span class="nb">source</span>
git add .
git commit -m<span class="s2">&quot;forked middleman for github user pages&quot;</span>
</code></pre></div>

<p>Now browse to <a href="http://www.github.com">Github</a> and manually create your repository. It must be named <em>username.github.io.git</em>, where the username is your github username.</p>

<p>Add a remote &amp; push &#39;origin source&#39;</p>

<div class="highlight"><pre><code class="bash">git remote add origin git@github.com:username/username.github.io.git
git push -u origin <span class="nb">source</span>
</code></pre></div>

<p>Create &#39;origin master&#39;, push and the remove it locally (trust me).</p>

<div class="highlight"><pre><code class="bash">git branch master
git push origin master
git branch -d
</code></pre></div>

<h3>Configure Middleman</h3>

<p>Uncomment the following in your <em>config.rb</em> and set the remote</p>

<div class="highlight"><pre><code class="ruby"><span class="c1"># github deploy</span>
<span class="n">activate</span> <span class="ss">:deploy</span> <span class="k">do</span> <span class="o">|</span><span class="n">deploy</span><span class="o">|</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="ss">:git</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">build_before</span> <span class="o">=</span> <span class="kp">true</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">branch</span>   <span class="o">=</span> <span class="s2">&quot;master&quot;</span>
  <span class="n">deploy</span><span class="o">.</span><span class="n">remote</span>   <span class="o">=</span> <span class="s2">&quot;git@github.com:username/username.github.io.git&quot;</span>
<span class="k">end</span>
</code></pre></div>

<h2>Deploy</h2>

<div class="highlight"><pre><code class="bash">bundle <span class="nb">exec </span>middleman deploy
</code></pre></div>

<h2>Browse</h2>

<p>The best feature of User Pages are that they have a nice url.  Browser to your new site with your username (ex. http://username.github.io)</p>

</div>

<a href="/">...back to all posts</a>


    </div>
  </main>
  <footer class="site-footer" role="contentinfo">
     <div class="container">
        beesbot 2014
      </div>
  </footer>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1550337-13', 'beesbot.com');
  ga('send', 'pageview');

</script>

</body>
</html>
